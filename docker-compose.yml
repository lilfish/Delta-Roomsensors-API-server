version: '3.7'

networks:
  roomsensor_bridge:
    name: roomsensor_bridge
    driver: bridge

services:
  # uwebsockets for socket connections
  rs_api_server:
    container_name: "rs_api_server"
    build:
      context: ./api
    ports:
      - 42069:42069
    networks:
      - roomsensor_bridge
    links:
        - rs_mongodb
    depends_on:
        - rs_mongodb
  rs_mongodb:
    image: mongo:latest
    container_name: "rs_mongodb"
    environment:
      - MONGO_DATA_DIR=/data/db
      - MONGO_LOG_DIR=/dev/null
      - MONGODB_USER="roomsensors" 
      - MONGODB_PASS="AGnKOyUisUwI5PStZKjXvaRmzJEtUmwk"
    volumes:
      - ./data/db:/data/db
    ports:
        - 27017:27017
    command: mongod --smallfiles --logpath=/dev/null # --quiet